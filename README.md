# Netology_Vkinder_Bot
#### *Дипломный модуль профессии Python-разработка для начинающих по проекту «Цифровые профессии»*
___
## Задание:
### Входные данные

Имя пользователя или его id в ВК, для которого мы ищем пару.
если информации недостаточно нужно дополнительно спросить её у пользователя.

### Требования к сервису:

- Код программы удовлетворяет `PEP8`.
Получать токен от пользователя с нужными правами.
- Программа декомпозирована на функции/классы/модули/пакеты.
- Результат программы записывать в БД.
- Люди не должны повторяться при повторном поиске.
- Не запрещается использовать внешние библиотеки для vk.
### Дополнительные требования (не обязательны для получения диплома):

- В vk максимальная выдача при поиске 1000 человек. Подумать как это ограничение можно обойти.
- Добавить возможность ставить/убирать лайк, выбранной фотографии.
- Можно усложнить поиск добавив поиск по интересам. Разбор похожих интересов(группы, книги, музыка, интересы) нужно будет провести с помощью анализа текста.
- У каждого критерия поиска должны быть свои веса. То есть совпадение по возрасту должны быть важнее общих групп. Интересы по музыке важнее книг. Наличие общих друзей важнее возраста. И так далее.
- Добавлять человека в избранный список, используя БД.
- Добавлять человека в черный список чтобы он больше не попадался при поиске, используя БД.
- К списку фотографий из аватарок добавлять список фотографий, где отмечен пользователь.
---
## Реализовано:
- Декомпозиция кода на отдельные функции/классы/модули/пакеты
- На основании информации о пользователе (пол, возраст, город) выполняется поиск партнёра противоположного пола с диапазоном плюс-минус 1 год от возраста пользователя, после отправки в чат текста **`Поиск`** или нажатия соответствующей кнопки
- Запись 1000 найденных результатов в таблицу `vk_users` БД PostgreSQL (хотя намного удобнее использовать для этих целей словарь)
- Отправка информации о пользователе (Фамилия, Имя, ссылка на страницу в VK) из списка + 5 ТОП фотографии со страницы пользователя на основании количества лайков и комментариев под фото
- При отправке в чат команты **`Следующие`** (или нажатии соответствующей кнопки) или повторной отправки команды **`Поиск`** выполняется выдача следующего пользователя из списка
- При отправке любой команды кроме **`Привет`** и **`Следующие`** (в коде вынесен целый ряд команд - исключений дублирующих функционал данной кнопки, на случай если пользователь решит написать боту с клавиатуры)  пользователю в чат отправляется уведомление о том что результаты поиска будут очищены, таблица `vk_users` удаляется
- Дебаг логирование в папку с местоположением кода бота - ***vkinder_log***, файл ***debug.log***
- Добавлены функцинальные кнопки, для упрощения взаимодействия с ботом. Вынесены в отдельный файл **`buttons.py`** в папку ***utils***

## Не реализовано:
- ~~Показ функциональных REPLY кнопок, для упрощения взаимодействия с ботом~~ **(РЕАЛИЗОВАНО)**
- Дополнительные условия выполнения дипломного проекта
- **Тупые требования не описанные в задании дипломного проекта**
- **Запрос ввести дополнительную информацию (город, пол, год рождения, рост, вес, размер ... и т.д)** по причине того, что после удаления города из профиля, ВК продолжает хранить id и название города, чтоб это проверить можно в 65 строке дописать {user_info["city"]}, в приветственном сообщении, предварительно удалив информацию в поле "город" на своей страницу в ВК. Пол вообще убрать из профиля не получается, ограничение ВК связанное с нововведениями, также как и возраст.

## Найденные баги:
- ~~Взаимодействие с ботом **всегда** начинается с отправки приветственного сообщения **`Привет`**. В случае отправки в чат другой команды, выполнение кода падает с ошибкой (**Такова логика работы бота**, можно подумать в будущем как изменить)~~ (**FIX IT**)
- После удаления таблицы `vk_users` и повторении выполнения действий по поиску партнёра, выдаются те же результаты поиска, в той же последовательности. ~~(**FIX IT**)~~ Баг вернулся после изменения логики работы бота
- Функциональные баги связанные с однопользователським режимом работы бота. Например: При одновременном подключении 2ух пользователей, пользователю 2 будут выдаваться результаты поиска по параметрам пользователя 1. (Для того чтоб пофиксить, необходимо переписать код бота используя асинхронные библиотеки, например ***asyncio***) 
___
Скачать данный репозиторий можно выполнив команду `git clone https://github.com/vanieljekoek/Netology_Vkinder_Bot` у себя на компьютере
